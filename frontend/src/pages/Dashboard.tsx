import { getFunctions, httpsCallable } from "firebase/functions";
import { auth } from "../firebase";

export default function Dashboard() {
  // üîç FUNCI√ìN DE PRUEBA TEMPORAL
  const testWhoAmI = async () => {
    try {
      // 1Ô∏è‚É£ Verificar usuario autenticado
      if (!auth.currentUser) {
        throw new Error("Usuario NO autenticado");
      }

      // 2Ô∏è‚É£ Usar REGI√ìN correcta
      const functions = getFunctions(undefined, "us-central1");

      // 3Ô∏è‚É£ Callable function
      const whoAmI = httpsCallable(functions, "whoAmI");

      const res = await whoAmI();

      console.log("WHOAMI:", res.data);
      alert(JSON.stringify(res.data, null, 2));
    } catch (err: any) {
      console.error("WHOAMI ERROR:", err);
      alert(err.message || "Error");
    }
  };

  return (
    <div style={{ padding: 40 }}>
      <h1>Dashboard</h1>
      <p>Vista general del hub</p>

      {/* üîò BOT√ìN TEMPORAL DE DEBUG */}
      <button
        onClick={testWhoAmI}
        style={{
          marginTop: 20,
          padding: "10px 16px",
          cursor: "pointer",
        }}
      >
        Test whoAmI
      </button>
    </div>
  );
}
